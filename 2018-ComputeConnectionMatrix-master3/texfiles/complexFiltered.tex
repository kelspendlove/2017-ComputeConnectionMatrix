%!TEX root = ../main.tex
\section{Lattice-Filtered Chain Complexes}\label{sec:lfc}



\begin{defn}
{\em
Let $\sL\in \bFDLat$.
An \emph{$\sL$-filtering of a chain complex $(C,\partial)$ over a field $k$} is a lattice homomorphism $f\colon \sL \to Sub(C,\partial)$.
The function $f$ is called an \emph{$\sL$-filtering}.
}
\end{defn}


Notice that since $f$ is a lattice homomorphism we have $0_L\rightsquigarrow 0$ and $1_L \rightsquigarrow (C,d)$.  Let $f\colon \sL \to Sub(C)$ and $g\colon \sL \to Sub(D)$ be $\sL$-filterings. 
A linear map $\phi\colon C\to D$ is {\em $\sL$-filtered} if
\[
\phi(f(a)) \subset g(a),\quad\text{for all $a\in\sL$}.
\]




\begin{ex}
{\em
For any $\sL$-filtering $f\colon \sL \to Sub(C,\partial)$,
the boundary map $\partial\colon C\to C$ is $\sL$-filtered.
}
\end{ex}

\begin{ex}

%A $J(L)$-graded cell complex gives rise to an $L$-filtered chain complex in the following fashion.   

Let $f\colon X\to \sJ(\sL)$ be a graded cell complex.  By Birkhoff's theorem there is a lattice homomorphism $O(f):\sL\to Sub_{Cl}(X,\preceq)$.  Each element of $Sub_{Cl}(X,\leq)$ is a basis for the associated closed subcomplex of $C(X)$ spanned by the downset.   Thus the map defined by $$L\ni q\rightsquigarrow span(O(f)(q))\in Sub(C(X))$$ is an $L$-filtered chain complex.  Therefore there is an assignment $Cell(\sJ(\sL))\to \bCF(\sL)$.


%There is an assignment $\cL:Cell(J(L))\to \bCF(\sL)$ and a graded-cell complex $f:X\to \sJ(\sL)$ is a graded basis for $\cL(f)$.
 
%$$Cell(\sJ(\sL))\to {\bf GCC(\sJ(\sL))} \to \bCF(\sL)$$
\end{ex}







The category $\bCF(\sL,k)$ has objects consisting of $\sL$-filterings of chain complexes over $k$.  The morphisms are the $\sL$-filtered chain maps.  For $f,g$ in $\bCF(\sL,k)$ we write $\phi\colon f\to g$ to indicate that $\phi$ is in $Hom_{\bCF}(f,g)$.   Let $f \colon \sL\to Sub(C,\partial^C)$ and $g \colon \sL\to Sub(D,\partial^D)$ be $\sL$-filterings over a field $k$.  
Two $\phi,\psi \colon f\to g$  $\sL$-filtering chain homomorphisms are {\em chain homotopic} if $h\colon f\to g$ is an $\sL$-filtering morphism satisfying
\[
\phi -\psi = h\partial^C+\partial^Dh.
\]
The $\sL$-filtering morphism $h$ is called a {\em filtered chain homotopy}.  
We write $\psi\sim \phi$ if $\psi$ and $\phi$ are filtered chain homotopic.  
It is straightforward that this is an equivalence relation.    Let $f \colon \sL\to Sub(C,\partial^C)$ and $f' \colon \sL\to Sub(D,\partial^C)$ be $\sL$-filtered complexes.  
Let $\phi \colon f\to f'$ and $\psi \colon f'\to f$ be filtered chain maps.  
A {\em filtered chain homotopy equivalence} consists of a quadruple $(\psi,\phi,h,g)$ such that 
\begin{enumerate}
\item $\psi\phi-id_C= h \partial^C + \partial^C h$
\item $\phi\psi-id_D = g \partial^D+\partial^D g$
\end{enumerate}



The homotopy category $\bK\bCF(\sL,k)$ has $\sL$-filtered chain complexes as objects.
The morphisms are given by the homotopy equivalence classes, i.e.\ $Hom_{\bK\bCF}(f,g) = Hom_{\bCF}(f,g)/\sim$ where $\sim$ is the homotopy equivalence relation.   
Isomorphisms in $\bK\bCF(\sL,k)$ correspond to filtered chain equivalences.





%
%\subsection{$\sP$-Graded Chain Complexes}\label{sec:lfc:grad}
%
%
%
%A $\sP$-graded chain complex is a chain complex $(C,\Delta)$ with decomposition $$C=\bigoplus_{q\in \sP} C_q$$ and boundary operator determined by its components $\Delta_{qp}:C_q\to C_p$ subject to the condition 
%\begin{align}\label{eqn:ut}
%\Delta_{qp}\neq 0\implies p\leq q
%\end{align}  The collection $\{\Delta_{qp}\}$ can be thought of as a matrix of linear maps. If a linear map satisfies condition~(\ref{eqn:ut}) we call it {\em $\sP$-graded}.  In~\cite{fran} this condition is referred to as {\em upper triangularity with respect to $\sP$}.   If $\Delta_{pp} = 0$ for all $p$ then the boundary map $\Delta$ is called a {\em connection matrix}.  In this case $\Delta$ can be interpreted as a map
%\begin{align}\label{eqn:cm}
%\Delta \colon \bigoplus_{q\in \sP} H_\bullet(C_q,\Delta_{qq})\to \bigoplus_{q\in \sP} H_\bullet(C_q,\Delta_{qq})
%\end{align}
%
%The identification of $\Delta$ with the matrix structure is the genesis of the phrase {\em connection matrix}.  We denote $\sP$-graded chain complexes by $(C^\oplus(\sP),\Delta)$ and often abbreviate this with $C^\oplus(P)=(C^\oplus(P),\Delta(P))$.  If $\Delta$ is a connection matrix for $(C^\oplus(\sP),\Delta)$ then we say $C^\oplus(\sP)$ is a {\em Conley complex}.  Equation~\ref{eqn:cm} implies that $\Delta$ is boundary map on Conley indices.  Therefore the notion of Conley complex is analogous to that of a Morse complex.
%
%A morphism of $\sP$-graded chain complexes is a $\sP$-graded chain map.   We call the category of $\sP$-graded chain complexes $\bf{GCC(\sP)}$.   Two $\sP$-graded chain maps $\Phi,\Psi:(C^\oplus(\sP),\Delta)\to (D^\oplus(\sP),\Delta')$ are {\em chain homotopic} if there  is a $\sP$-graded degree+1 map $\Gamma:C^\oplus(\sP)\to D^\oplus(\sP)$ such that 
%\[
%\Phi-\Psi = \Gamma\Delta - \Delta\Gamma
%\]
% The map $\Gamma$ is called a {\em graded chain homotopy}.  The associated associated homotopy category ${\bf KGCC(\sP)}$ has $\sP$-graded chain complexes as objects and morphisms given by homotopy equivalences classes.     For a subset $I\subseteq \sP$ we set 
%\[
%C^\oplus(I) = \bigoplus_{p\in I} C_p\quad\quad \quad \Delta(I) = \pi_{P,I} \circ \Delta \circ \iota_{I,P}
%\]
% where $\iota_{I,P}:C^\oplus(I)\to C^\oplus(P)$ and $\pi_{P,I}:C^\oplus(P)\to C^\oplus(I)$ are the natural inclusion and projection.  In general $C^\oplus(I)$ is neither a subcomplex nor a chain complex.  When $I$ is convex in $\sP$ it is straightforward that $\Delta(I)\circ\Delta(I) = 0$ and $(C^\oplus(I),\Delta(I)$ is a chain complex.  In fact, it may be regarded as $(\sI,\leq)$-graded chain complex where $(\sI,\leq)$ is the restriction of $(\sP,\leq)$ to $\sI$.   
% 
%  For each lower set $a\in \sO(\sP)$ we have $\Delta(C^\oplus(a))\subseteq C^\oplus(a)$ is $\Delta$ is $\sP$-graded.  Thus $\Delta(a)=\Delta|_{C^\oplus(a)} $. This implies that $(C^\oplus(a),\Delta(a))$ is a subcomplex of $(C^\oplus(\sP),\Delta)$.    
  
  
 We can now explore the relationship between graded and filtered complexes.  Every $\sP$-graded chain complex $(C^\oplus(\sP),\Delta)$ determines an $\sL$-filtered chain complex $h:\sO(\sP)\to Sub(C,\Delta)$ via $$\sO(\sP)\ni a \rightsquigarrow (C^\oplus(a),\Delta(a))\in Sub(C,\Delta)$$


This defines an assignment $\mathfrak{L}\colon {\bf GCC}(\sJ(\sL))\to \bCF(\sL)$.  A morphism of $\sP$-graded chain complexes induces a morphism between the associated lattice-filtered complexes.  This is captured as a corollary of the next result.


\begin{prop}
The assignment $\mathfrak{L}\colon {\bf GCC}(\sJ(\sL))\to \bCF(\sL)$ is an additive functor.  Moreover $\mathfrak{L}$ descends to a functor on homotopy categories $K(\mathfrak{L}):{\bf KGCC}\to {\bf KLFC}$.
\end{prop}
\begin{proof}
It is straightforward that $\mathfrak{L}$ is an additive functor.  Let $(C^\oplus(\sP),\Delta)$ and  $(D^\oplus(\sP),\Delta')$  be $\sJ(\sL)$-graded complexes.  Denote by $f\colon \sL\to Sub(C,\Delta)$ and $g\colon \sL\to Sub(D,\Delta')$ the associated filtered complexes $\mathfrak{L}(C^\oplus(\sP))$ and $\mathfrak{L}(D^\oplus(\sP))$.  Any $\sJ(\sL)$-graded homotopy $\Gamma:C^\oplus(\sP)\to D^\oplus(\sP)$ is an $\sL$-filtered homotopy $f\to g$ since
\[
\Gamma(f(a))= \Gamma(C^\oplus(a)) \subseteq D^\oplus(a) = g(a)
\]
Therefore any graded homotopy equivalence is a filtered homotopy equivalence and  shows that the functor $\mathfrak{L}$ descends to the homotopy categories.
\end{proof}

We highlight the following simple objects of $\bCF$. In the filtered case, this is the analogue of the Conley complex and connection matrix.  This is formalized in the next by Proposition~\ref{prop:filt:cm}.



\begin{defn}
{\em 
An $\sL$-filtering $f\colon \sL \to Sub(C,\partial)$ is a \em{Conley filtering} if
\[
\partial(f(a)) \subseteq f(Pred(a))
\]
for all $a\in J(\sL)$.
}
\end{defn}



\begin{prop}\label{prop:filt:cm}
If $(C^\oplus(\sJ(\sL)),\Delta)$ is a Conley complex then $\mathfrak{L}(C^\oplus(\sJ(\sL)),\Delta)$ is a Conley-filtering.
\end{prop}



In the previous section we discussed the functor $\mathfrak{L}$ which constructs filtered chain complexes from graded ones.  One can reverse the process and construct a $\sJ(\sL)$-graded chain complex from an $\sL$-filtered chain complex.  However such constructions are typically not unique nor functorial.


\begin{defn}
{\em
Consider $f:\sL\to Sub(C,d)$.  A {\em graded basis for $h$} is a collection $\cB\subseteq C$ with a map $\nu:\cB\to \sJ(\sL)$ such that for each $q\in \sO(\sJ(\sL))$ the set $\nu^{-1}(q)$ is a basis for $f(q)$.
 The function $\nu$ is called the {\em valuation}. As $\sO(\sJ(\sL)) \cong \sL$ we'll often refer to $\nu^{-1}(q)$ for $q\in \sL$.  
}
\end{defn}

Graded bases are closely related to the idea of graded cell complexes, as introduced in Section~\ref{sec:grad}.  In particular, a graded bases determines a graded cell complex if one defines the underlying poset using Eqn.~\ref{eqn:poset}.  On the other hand, if one begins with a graded-cell complex $f:X\to \sJ(\sL)$ then $f$ is a graded basis for $\cL(f)$, the associated $\sL$-filtered chain complex.   The next proposition shows that for $\sL$-filtered chain complexes over fields, one can always find a graded basis.  Note that distributivity of $\sL$ is a necessary ingredient in this result.

\begin{prop}\label{prop:bases}
For any $\sL$-filtered complex $f:\sL\to Sub(C,d)$ there is a graded basis $(\cB,\nu)$.
\end{prop}
\begin{proof}
We first construct subspaces associated to each $q\in J(L)$, then we may select a basis for these subspaces.  Let $q\in J(L)$.  We have $Pred(q)=\bigvee_i p_i$.  Thus $f(Pred(q)) = f(p_1)+\ldots + f(p_n)$.    Choose a subspace $V_q$ such that $f(q) = V_q \oplus f(Pred(q))$. Notice that for any $q$ that covers $0_L$ we have $Pred(q)=0_L$, so $f(Pred(q)) = 0$ and $V_q = f(q)$.

We'll show that $V_q\cap V_p=0$ for $q\neq p$.  Let $x\in V_q\cap V_p$.  Then $x\in f(q)\cap f(p) = f(q\wedge p)$.  However, $f(q\wedge p)\subseteq f(Pred(q))$ and $f(p\wedge p)\subseteq f(Pred(p))$.  Thus $x=0$ by choice of $V_q$ and $V_p$.  

Choose a basis $\cB_q$ for each $V_q$.  Since $V_q\cap V_p=0$ for $p\neq q$ these bases are pairwise disjoint. Let $\cB=\bigsqcup_q \cB_q$ and define $\nu:\cB\to J(L)$ by $\nu(x) = q$ if $x\in \cB_q$.


  It remains to show that for any $a\in \sL$ the set $\nu^{-1}(a) = \bigsqcup_{q\in a} \cB_q $ is a basis for $f(q)$.  We'll do this using an inductive argument.  Let $q\in \sL$ and assume that for each $p<q$ we have $\nu^{-1}(p)$ is a basis for $f(p)$.  Let $x\in f(q)$.  Since $f(q) = V_q\oplus f(Pred(q))$ we have $x = x_q+x_{Pred(q)}$.  $V_q$ is spanned by $\cB_q$.  We have $Pred(q) = \bigvee_i p_i$ with $p_i\in \sJ(\sL)$.  Thus $f(Pred(q)) = f(p_1) + \ldots + f(p_n)$.  
  
  
%   It suffices to show that it spans.  Let $x\in f(q)$.  
%  
%  
%  Now we'll argue that $\bigoplus_{q\in J(L)} V_q$ span $C$.
%
%Now we wish to show that $\bigoplus_{q\in J(L)} V_q$ span $C$.  We will prove this by strong induction.  We will induct over a linear extension of $L$.  The base case is to consider the minimal element, $0_L\in L$.  By (4) of~\ref{def:cf} if $f(x)=0_L$ then $x=0$, which is in the span.   Now fix $p\in L$.  The strong inductive hypothesis is to assume that for any $q< p$ any $x$ with $f(x)=q$ is in span $\bigoplus_{q\in J(L)} V_q$.  Let $p\in L$.  By Lemma~\ref{lem:join} we may write $p$ as an irredundant join $p=\bigvee_i q_i$ with $q_i \in J(L)$. Notice if $p\in J(L)$ then the decomposition is trivially written as $p=p$.  Coherence implies that $D_p = D_{q_1}+D_{q_2}+\ldots+D_{q_n}$.  Thus $x= \sum_i \lambda_i x_{q_i}$.  There are two cases.  First, if $p\not\in J(L)$, then $q_i< p$ and each $x_{q_i}$ belongs to the span.  For the second case, $p\in J(L)$ and we may write $D_p = V_p \bigoplus D_{Pred(p)}$.  Thus $x = v_p + x_{Pred(p)}$.  Since $Pred(p)<p$ the inductive hypothesis implies that $x_{Pred(p)}$ is in the span. 
\end{proof}


\begin{cor}
\label{prop:Lsplitting}
Any $\sL$-filtered complex $f\colon \sL\to Sub(C,\partial)$ determines a $\sJ(\sL)$-graded chain complex $(C^\oplus(\sJ(\sL)),\Delta)$  such that $$f(a)= (C^\oplus(a),\Delta(a))$$

and in particular for $a\leq b$ we have $f(b)/f(a) \cong (C^\oplus(b-a),\Delta(b-a))$.

%\begin{enumerate}
%\item for any $a\in L$ $$\bigoplus_{q\leq a} C_q \cong f(a)$$
%\end{enumerate}
\end{cor}

We call the associated $\sP$-graded complex a $J(L)$-splitting.  In general splitting is not unique, and depend upon the choice of graded basis.   The Conley filtered chain complexes are central in the theory, as with regard to the $J(L)$-splitting, the boundary map is a connection matrix.

\begin{cor}
Let $f\colon \sL \to Sub(C,\partial)$  be a Conley filtering. Then $f$ determines a $\sJ(\sL)$-graded Conley complex $(C^\oplus(\sJ(\sL)),\Delta)$ such that
\[
H_\bullet(f(a)/f(Pred(a))) \cong C^\oplus(a-Pred(a))
\]
\end{cor}

In this case we may interpret $\Delta$ as an $\sP$-graded boundary map on homology
\[
\Delta \colon \bigoplus_{a\in \sJ(\sL)} H(f(a)/f(Pred(a)) \to \bigoplus_{a\in \sJ(\sL)} H(f(a)/f(Pred(a))
\]


Finally, in analogy to Proposition~\ref{prop:grad:cmiso}, we have that chain homotopy equivalent Conley filterings are chain isomorphic.

 \begin{prop}\label{prop:filt:cmiso}
 Let $f:\sL\to Sub(C,d)$ and $g:\sL\to Sub(D,d')$ be $\sL$-Conley filtered chain complexes.  If $f$ and $g$ are filtered chain equivalent, then $f$ and $g$ are filtered chain isomorphic.
 
 \end{prop}
 \begin{proof}
From Proposition~\ref{prop:bases} there are graded bases $(\cB,\nu)$ and $(\cB',\nu')$ for $f$ and $g$ respectively.  Let $C^\oplus(\sJ(\sL))$ and $D^\oplus(\sJ(\sL))$ be the associated $\sJ(\sL))$-graded Conley complexes.  The $\sL$-filtered maps $\phi:C\to D$ and $\psi:D\to C$ can be written as matrices $\Phi$ and $\Psi$ with respect to the bases $\cB$ and $\cB'$.  In this way they determine $\sJ(\sL)$-graded maps on $C^\oplus(\sJ(\sL))$ and $D^\oplus(\sJ(\sL))$.  From Proposition~\ref{prop:grad:cmiso} the maps $\Phi$ and $\Psi$ are chain isomorphisms.  Thus $\phi$ and $\psi$ are chain isomorphisms.
  \end{proof}



\begin{thm}
Let $f:X\to \sJ(\sL)$ be a graded cell complex and $\cL(f)$ be the associated $\sL$-filtered chain complex..  Let $(C^\oplus(\sJ(\sL)),\Delta)$ be the associated $\sJ(\sL)$-graded chain complex.  If $(A^\oplus(\sJ(\sL)),\Delta_A)$ is a Conley complex which is homotopy-equivalent to $(C^\oplus(\sJ(\sL)),\Delta)$ then $\mathfrak{L}(A^\oplus(\sJ(\sL)),\Delta_A)$ is a Conley filtering which is filtered homotopy equivalent to $\cL(f)$.
\end{thm}












