%!TEX root = ../main.tex

\subsection{Algorithm}

A splitting fibration homotopy is a splitting homotopy and a fibration homotopy.

\begin{prop}
Let $f:C\to L$ be a chain fibration.  Let $\gamma$ be a splitting fibration homotopy.  Let $(M_\gamma, \Delta_\gamma)$ be the associated Morse complex.  Let $(\phi,\psi)$ be the Morse equivalences.  Define $g:(M_\gamma,\Delta_\gamma) \to L$ via $g:= f\circ \psi$.  Then $g$ is a coherent chain fibration and $g$ is homotopy equivalent to $f$.  

\end{prop}
\begin{proof}
$\psi$ is a section of $\phi$ by Proposition~\ref{prop:MorseEquiv}, thus it is injective.  Propositions~\ref{prop:compCF},~\ref{prop:compCoherent} imply $g$ is a coherent chain fibration.  We claim that the pair $(\phi,\psi)$ are equivalences between $f$ and $g$.  We first show that $\phi:f\to g$ and $\psi:g\to f$ are order-preserving maps.  $f\circ \psi = g$ thus $\psi$ is order-preserving.  $g\circ \phi = (f\circ \psi)\circ \phi = f(id_C - \gamma\partial_C - \partial_C \gamma) \leq f(x)$ as $\gamma$ and $\partial_C$ are order-preserving. Thus $\phi:f\to g$ is order-preserving.   Now $\phi \circ \psi = id_M$ and $\psi \circ \phi = id_C - \gamma \partial_C - \partial_C\gamma$, so $f$ and $g$ are homotopy equivalent.


\end{proof}

\begin{prop}
Let $f_c:X\to P$ be a cell fibration.  Let $(A,\mu)$ be an acyclic partial matching satisfying $\mu(Q)=K$ only if $K,Q\in f^{-1}p$ for some $p\in P$.  Then $\gamma_M$, the splitting homotopy from $M$ is order-preserving $f\to f$.
\end{prop}


\begin{proof}
Let $p\in P$.  Consider the $M_p$, the matching restricted to the fiber $f^{-1}p$.  By assumption this is an acyclic partial matching on the fiber $f^{-1}p$.  Thus by Proposition~\ref{prop:matchinghomotopy} there is a splitting homotopy $\gamma_p:C(f^{-1}p)\to C(f^{-1}p)$.     We have that $C=\bigoplus_{p\in P} C(f^{-1}p)$.  Consider $\Gamma:= \bigoplus_{p\in P} \gamma_p$.  $\Gamma$ is a diagonal endomorphism $C\to C$ and $\Gamma=\gamma_M$, the matching associated to $M$.  Since $\Gamma$ is diagonal with respect to the join-irreducible decomposition of $C$, it is order-preserving.

\end{proof}


{\bf Algorithm}
\begin{enumerate}
\item Given a coherent fibration $f_n$
\item Choose a compatible basis (existence is guaranteed from Theorem~\ref{thm:cfdecomp} (\ref{thm:cfdecomp:basis})
\item Use~\cite[Algorithm 3.6]{focm} to produce an acyclic partial matching $(A,\mu:Q\to K)$
\item Use~\cite[Algorithm 3.12]{focm} to produce a splitting homotopy, with associated equivalences $(\phi,\psi)$
\item Construct a new fibration $f_{n+1}:=f_n\circ \psi$
\item Proceed until $f_{n+1}=f_n$ for some $n$
\end{enumerate}

\begin{prop}[Algorithm Correctness]
 The above algorithm terminates, i.e. after finitely many iterations the sequence $(f_n)$ stabilizes to a final fibration $f_\infty$.  Moreover, $f_\infty$ is a connection fibration strictly equivalent to $f_0$.
\end{prop}













